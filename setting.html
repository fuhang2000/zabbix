<!DOCTYPE html>
<html lang="zh">

	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-transform">
		<title>设置</title>
		<link rel="stylesheet" href="css/setting.css">
		<link rel="stylesheet" href="css/twoStageSwitch.css">
		<script src="js/zepto.min.js"></script>
		<script src="js/all.js"></script>
	</head>

	<body>

		<div class="header">
			<a href="javascript:history.back(-1)"><img class="img1" src="img/nav_icon_back_normal.png"></a>
			<span>设置</span>
		</div>

		<div class="mycontainer">

			<div class="mycontainer-content">
				<div class="mycontainer-alarm"><span>开关</span></div>
			</div>
			<div class="mycontainer-contai">
				<ul>
					<li class="mycontainer-specific" id="close">
						<img src="img/set_btn_exit.png">
						<span class="text">关闭交换机</span>
					</li>
					<li class="mycontainer-specific" id="restart">
						<img src="img/set_btn_restart.png">
						<span class="text">重启交换机</span>
					</li>
				</ul>
			</div>

			<div class="mycontainer-content">
				<div class="mycontainer-alarm"><span>设置</span></div>

			</div>

			<div class="mycontainer-contai">
				<ul>

					<li class="mycontainer-specific">

						<div class="left">
							<span style="margin-left: 0.125rem;">修改名称</span>
						</div>

						<div class="right">
							<img id="write" class="img2" src="img/list_btn_changeset_normal.png">
						</div>
					</li>

					<a href="trafficSetting.html">
						<li class="mycontainer-specific">

							<div class="left">
								<span style="margin-left: -3.125rem;">流量控制</span>
							</div>

							<div class="right">
								<img src="img/btn_enter_normal.png" style="margin: 0">
							</div>
						</li>
					</a>
					<a href="alarmThresholdSetting.html">
						<li class="mycontainer-specific">
							<div class="left">
								<span style="margin-left: -3.925rem;">告警阈值</span>
							</div>
							<div class="right">
								<img src="img/btn_enter_normal.png" style="margin: 0">
							</div>
						</li>
					</a>
				</ul>
			</div>

			<div class="mycontainer-content">
				<div class="mycontainer-alarm">
					<span style="margin-left: -4rem">其他</span>
				</div>
			</div>
			<div class="mycontainer-contai">
				<ul>
					<a href="thirdParty.html">
						<li class="mycontainer-specific">
							<div class="left">
								<span style="margin-left: 0.725rem;">第三方应用授权</span>
							</div>
							<div class="right">
								<img src="img/btn_enter_normal.png" style="margin: 0">
							</div>
						</li>
					</a>
				</ul>
			</div>

		</div>

		<div id="bg"></div>
		<div id="show">
			<div>
				<img src="img/pop_icon_restart.png">
			</div>
			<span>是否关闭交换机？<br>
        设备关闭后需自行至机房重启。</span>
			<div id="btn">
				<button id="btn_yes">是</button><button id="btn_no">取消</button>
			</div>
		</div>
		<div id="bg1"></div>

		<div id="show1">
			<div>
				<img src="img/pop_icon_restart.png">
			</div>
			<span>是否重启交换机？</span>
			<div id="btn1">
				<button id="btn_yes1">是</button><button id="btn_no1">取消</button>
			</div>
		</div>

		<div id="bgs"></div>
		<div id="shows">
			<span id="titles">设备名称</span>
			<div id="ins">
				<input type="text" value="" id="inps"><img id="cleartexts" src="img/btn_cleartext.png">
			</div>
			<div id="btns">
				<button id="btn_yess">取消</button><button id="btn_nos">保存</button>
			</div>
		</div>
		<script>
			$(function() {

				var JsonStr = localStorage.getItem("json");

				var Entity = JSON.parse(JsonStr);

				/*关闭交换机*/
				$("#close").bind("click", function() {
					document.getElementById("bg").style.display = "block";
					document.getElementById("show").style.display = "block";
					//                $('html,body').animate({scrollTop: '0px'}, 100);//因为页面很长，有纵向滚动条，先让页面滚动到最顶端，然后禁止滑动事件，这样可以使遮罩层锁住整个屏幕
					$('#bg').bind("touchmove", function(e) {
						e.preventDefault();
					});
				});
				$("#btn_yes").bind("click", function() {
					document.getElementById("bg").style.display = "none";
					document.getElementById("show").style.display = "none";
				});
				$("#btn_no").bind("click", function() {
					document.getElementById("bg").style.display = "none";
					document.getElementById("show").style.display = "none";
				});
				/*重启交换机*/
				$("#restart").bind("click", function() {
					document.getElementById("bg1").style.display = "block";
					document.getElementById("show1").style.display = "block";
					//                $('html,body').animate({scrollTop: '0px'}, 100);//因为页面很长，有纵向滚动条，先让页面滚动到最顶端，然后禁止滑动事件，这样可以使遮罩层锁住整个屏幕
					$('#bg').bind("touchmove", function(e) {
						e.preventDefault();
					});
				});
				$("#btn_yes1").bind("click", function() {
					document.getElementById("bg1").style.display = "none";
					document.getElementById("show1").style.display = "none";
				});
				$("#btn_no1").bind("click", function() {
					document.getElementById("bg1").style.display = "none";
					document.getElementById("show1").style.display = "none";
				});
				$("#inps").click(function() {
					$("#btn_nos").css({
						background: "#1ab301",
						color: "#ffffff"
					});

					/*保存*/
					//            if(!$("#inp").val()){
					console.info("变化了");

					$("#btn_nos").removeAttr("disabled", "disabled");
				});
				$("#btn_nos").bind("click", function() {
                         var newname=$("#inps").val();
					$("#write").prev().text($("#inps").val());
					document.getElementById("bgs").style.display = "none";
					document.getElementById("shows").style.display = "none";
					$("#btn_nos").css({
						background: "#ebebeb",
						color: "#999999"
					});
					
									var updatename = {
					"jsonrpc": "2.0",
					"method": "host.update",
					"params": {
						"output": "extend",
						"hostid": Entity.id,
						"name":newname,
						
					},
					"auth": Entity.auth,
					"id": 1
				}
					$.ajax({
					type: "post",
					async: false,
					contentType: "application/json;charset=utf-8",
						url:"http://123.207.235.243/api_jsonrpc.php",
						
					data: JSON.stringify(updatename),

					dataType: "json",
					success: function(result) {
						
						
							alert(JSON.stringify(result))
							
						
						
					}
					
					});
				});
				//            }else {
				$("#inps").focus();
				$("#btn_nos").attr("disabled", "disabled");
				//            }

				/*点击×按钮时*/
				$("#cleartexts").bind('click', function() {
					$("#inps").val("");
				});

				$("#write").bind('click', function() {
					document.getElementById("bgs").style.display = "block";
					document.getElementById("shows").style.display = "block";
					$("#btn_nos").attr("disabled", "disabled");
					$("#inps").val($(this).prev().text());
					$('#bgs').bind("touchmove", function(e) {
						e.preventDefault();
					});
					/*取消*/
					$("#btn_yess").bind("click", function() {
						$("#write").prev().find(".num").text($("#write").prev().find(".num").text());
						document.getElementById("bgs").style.display = "none";
						document.getElementById("shows").style.display = "none";
						$("#btn_nos").css({
							background: "#ebebeb",
							color: "#999999"
						});
					});

				});
			});
		</script>
	</body>

</html>